<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="QiView"><meta property="og:type" content="article"><meta property="og:image" content="https://SurpriseQiD.github.io//img/home-bg-painting.jpg"><meta property="twitter:image" content="https://SurpriseQiD.github.io//img/home-bg-painting.jpg"><meta name=title content="因果图（DAGs）：让因果关系可视化"><meta property="og:title" content="因果图（DAGs）：让因果关系可视化"><meta property="twitter:title" content="因果图（DAGs）：让因果关系可视化"><meta name=description content="QiView — 一个专注于计算与决策科学的学术知识平台，提供博弈论、机器学习、因果推断等领域的系统化知识。"><meta property="og:description" content="QiView — 一个专注于计算与决策科学的学术知识平台，提供博弈论、机器学习、因果推断等领域的系统化知识。"><meta property="twitter:description" content="QiView — 一个专注于计算与决策科学的学术知识平台，提供博弈论、机器学习、因果推断等领域的系统化知识。"><meta property="twitter:card" content="在复杂的因果关系网络中，我们如何清晰地表达变量之间的关系，并识别出哪些变量需要被控制，哪些不应该？本文将介绍Judea Pearl发展的强大工具——有向无环图（DAGs），它能帮助我们用直观的图形语言来推理因果关系。"><meta name=keyword content="博弈论, 决策科学, 运营管理, 人机交互, 机器学习, 因果推断, 大语言模型"><link rel="shortcut icon" href=/img/favicon.png><title>因果图（DAGs）：让因果关系可视化 | QiView | 计算与决策科学知识平台</title><link rel=canonical href=/knowledge/%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD/ci-dags/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><link rel=stylesheet href=https://SurpriseQiD.github.io/css/custom.css><link rel=stylesheet href=https://SurpriseQiD.github.io/css/resources.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-CX84QDN0SR"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CX84QDN0SR")}</script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar-main aria-expanded=false>
<span class=sr-only>切换导航</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/><span class=brand-text>QiView</span></a></div><div class="collapse navbar-collapse" id=navbar-main><ul class="nav navbar-nav navbar-right"><li><a href=/>首页</a></li><li><a href=/knowledge/>知识库</a></li><li><a href=/research/>研究</a></li><li><a href=/blog/>博客</a></li><li><a href=/resources/>资源</a></li><li><a href=/search/>搜索</a></li><li><a href=/about/>关于</a></li><li><a href=/search class=nav-search><i class="fa fa-search"></i></a></li></ul></div></div></nav><script>document.addEventListener("DOMContentLoaded",function(){var n,e=document.querySelector(".navbar-toggle"),t=document.querySelector(".navbar-collapse");e&&e.addEventListener("click",function(){this.classList.toggle("collapsed"),t.classList.toggle("in");var e=this.getAttribute("aria-expanded")==="true";this.setAttribute("aria-expanded",!e)}),n=document.querySelectorAll(".navbar-nav a"),n.forEach(function(n){n.addEventListener("click",function(){window.innerWidth<992&&(t.classList.remove("in"),e&&(e.classList.add("collapsed"),e.setAttribute("aria-expanded","false")))})}),document.addEventListener("click",function(n){var s=n.target.closest(".navbar");!s&&window.innerWidth<992&&(t.classList.remove("in"),e&&(e.classList.add("collapsed"),e.setAttribute("aria-expanded","false")))})})</script><header class=intro-header style=background-image:url(/img/home-bg-painting.jpg)><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><h1>QiView</h1><span class=subheading>构建系统化的学术知识生态系统</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-1
col-md-8 col-md-offset-1
col-sm-12
col-xs-12
post-container"><h2 id=1-为什么需要因果图>1. 为什么需要因果图？</h2><p>在上一篇文章中，我们介绍了潜在结果框架，它在定义因果效应方面非常强大。但当系统中涉及多个变量时，仅仅依靠数学公式来描述它们之间的关系会变得非常复杂和不直观。</p><p>**有向无环图（Directed Acyclic Graphs, DAGs）**提供了一种互补的方法。它是一种图形化的建模工具，让我们能够：</p><ul><li><strong>清晰地表达</strong>我们关于世界如何运作的因果假设。</li><li><strong>直观地识别</strong>变量之间的因果路径和非因果路径（相关性路径）。</li><li><strong>系统地判断</strong>为了估计特定因果效应，我们需要控制（调整）哪些变量。</li></ul><p>一个DAG由**节点（Nodes）<strong>和</strong>有向边（Directed Edges）**组成。</p><ul><li><strong>节点</strong>：代表我们关心的变量（如处理、结果、其他协变量）。</li><li><strong>有向边</strong>：从A指向B的箭头（A -> B）表示我们假设“A是B的一个直接原因”。</li><li><strong>无环（Acyclic）</strong>：图中不存在任何从一个节点出发，沿着箭头方向最终能回到自身的路径。这是因为我们假设一个事件不能成为自己的原因。</li></ul><h2 id=2-dag中的三种基本结构>2. DAG中的三种基本结构</h2><p>所有复杂的DAG都可以分解为三种基本结构，理解它们是掌握DAGs的关键。</p><p>假设我们想研究X对Y的因果效应（X -> Y）。</p><h3 id=结构一链chain>结构一：链（Chain）</h3><p><code>X -> M -> Y</code></p><ul><li><strong>描述</strong>: X通过一个中介变量M来影响Y。</li><li><strong>例子</strong>: 吸烟（X） -> 肺部焦油积累（M） -> 肺癌（Y）。</li><li><strong>关联</strong>: 在这种结构中，X和Y是相关的。</li><li><strong>控制后果</strong>: 如果我们<strong>控制（Condition on）<strong>了中介变量M（比如，只选择那些肺部焦油积累程度相同的病人进行比较），X和Y之间的关联就会被</strong>阻断（Block）</strong>。这在因果推断中通常是我们不希望看到的，因为我们想了解X通过所有路径对Y产生的总效应。</li></ul><h3 id=结构二分叉fork-混淆confounding>结构二：分叉（Fork）/ 混淆（Confounding）</h3><p><code>X &lt;- C -> Y</code></p><ul><li><strong>描述</strong>: 存在一个共同原因C，它同时影响X和Y。C被称为<strong>混淆变量（Confounder）</strong>。</li><li><strong>例子</strong>: 冰淇淋销量（X）和溺水人数（Y）都受到季节温度（C）的影响。冰淇淋销量和溺水人数高度相关，但它们之间没有因果关系。</li><li><strong>关联</strong>: 共同原因C打开了一条从X到Y的“后门路径”（spurious path），使得X和Y变得相关，即使它们之间没有直接的因果箭头。</li><li><strong>控制后果</strong>: 为了估计X对Y的纯粹因果效应，我们<strong>必须控制</strong>混淆变量C。通过控制C（比如，在相同的温度下比较），我们就关闭了这条后门路径，消除了混淆偏误。</li></ul><h3 id=结构三对撞collider>结构三：对撞（Collider）</h3><p><code>X -> Z &lt;- Y</code></p><ul><li><strong>描述</strong>: X和Y都是第三个变量Z的原因。Z被称为<strong>对撞点（Collider）</strong>。</li><li><strong>例子</strong>: 一个人的天赋（X）和努力程度（Y）共同决定了他是否能成为一个成功的科学家（Z）。</li><li><strong>关联</strong>: 在默认情况下（不控制Z时），X和Y是<strong>独立</strong>的（假设天赋和努力之间没有直接关联）。知道一个人的天赋并不能告诉你他是否努力。</li><li><strong>控制后果</strong>: 这是最反直觉的一点：如果我们<strong>控制了对撞点Z</strong>，反而会<strong>打开</strong>一条X和Y之间的关联路径。比如，如果我们只看那些成功的科学家（即控制Z=1），我们会发现在这个群体中，天赋和努力之间呈现出负相关。因为对于一个成功的科学家，如果他的天赋不高，那他一定非常努力；反之亦然。这种由控制对撞点而产生的偏误被称为<strong>对撞偏误（Collider Bias）<strong>或</strong>选择性偏误（Selection Bias）</strong>。</li></ul><h2 id=3-后门准则-back-door-criterion>3. 后门准则 (Back-door Criterion)</h2><p>基于对这三种结构的理解，Pearl提出了著名的<strong>后门准则</strong>，它为我们“应该控制哪些变量”提供了一个系统性的指导。</p><blockquote><p><strong>后门准则</strong>：为了识别X对Y的因果效应，我们需要找到一个变量集合S，对S进行控制，如果S满足以下两个条件：</p><ol><li>S能够阻断所有从X到Y的“后门路径”。（后门路径是指进入X的箭头所起始的路径）</li><li>S中不包含任何X到Y的因果路径上的中介变量，也不包含任何对撞点。</li></ol></blockquote><p>简单来说，就是要**“阻断所有后门，但不要触碰前门（因果路径），也不要错误地打开被对撞点关闭的路径”**。</p><h2 id=4-实践应用>4. 实践应用</h2><p>假设你想研究“上大学（X）对未来收入（Y）的影响”。</p><ul><li><strong>混淆变量（需要控制）</strong>: 学生的家庭背景、个人能力等（C）。这些变量既影响一个人上大学的可能性，也影响他未来的收入。根据分叉结构，我们必须在模型中控制这些变量。</li><li><strong>中介变量（不应控制）</strong>: 上大学可能通过“获得更高技能”（M1）、“建立更广人脉”（M2）等路径来影响收入。<code>大学 -> 技能 -> 收入</code>。根据链结构，如果我们控制了这些中介变量，就无法衡量上大学的全部效果了。</li><li><strong>对撞变量（不应控制）</strong>: 假设“体育特长”（A）和“学术能力”（B）都能增加被名校录取（Z）的概率。如果我们只研究名校毕业生（控制Z=1），可能会错误地发现体育特长和学术能力之间存在负相关，从而产生对撞偏误。</li></ul><h2 id=5-结论>5. 结论</h2><p>因果图（DAGs）是一种强大而直观的思维工具。它强迫我们清晰地思考和表达我们的因果假设，并提供了一套严谨的规则来指导我们如何处理数据以避免偏误。在进行任何因果分析之前，画出你脑中的因果图，是迈向可靠结论的第一步。它将抽象的统计问题，转化为了一个更易于理解和推理的图形问题。</p><script src=https://giscus.app/client.js data-repo=SurpriseQiD/hugo-main data-repo-id data-category=Announcements data-category-id data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-lang=zh-CN crossorigin=anonymous async></script></div><div class="col-lg-3 col-md-3 col-sm-12
sidebar-column"><div class=sidebar-container><div class=short-about><div class=sidebar-avatar><a href=/about><img src=/img/avatar-patrickStar.jpg alt=avatar></a></div><p class=sidebar-description>专注于计算与决策科学的学术知识分享平台</p><div class="sidebar-social inline"><a href=mailto:dongq@mail.ustc.edu.cn title=Email aria-label=Email><i class="fas fa-envelope"></i>
</a><a target=_blank href=https://github.com/SurpriseQiD title=GitHub aria-label=GitHub><i class="fab fa-github"></i>
</a><a target=_blank href=https://www.researchgate.net/profile/Qi-Dong-20 title=ResearchGate aria-label=ResearchGate><i class="fab fa-researchgate"></i>
</a><a target=_blank href="https://scholar.google.com/citations?user=dEDX5coAAAAJ&amp;hl=zh-CN&amp;oi=sra" title="Google Scholar" aria-label="Google Scholar"><i class="fas fa-graduation-cap"></i>
</a><a target=_blank href=https://orcid.org/0000-0002-3052-6332 title=ORCID aria-label=ORCID><i class="fab fa-orcid"></i></a></div></div><div class="sidebar-module toc-module"><h4><i class="fas fa-list-alt"></i> 目录</h4><nav id=TableOfContents><nav id=TableOfContents><ul><li><a href=#1-为什么需要因果图>1. 为什么需要因果图？</a></li><li><a href=#2-dag中的三种基本结构>2. DAG中的三种基本结构</a><ul><li><a href=#结构一链chain>结构一：链（Chain）</a></li><li><a href=#结构二分叉fork-混淆confounding>结构二：分叉（Fork）/ 混淆（Confounding）</a></li><li><a href=#结构三对撞collider>结构三：对撞（Collider）</a></li></ul></li><li><a href=#3-后门准则-back-door-criterion>3. 后门准则 (Back-door Criterion)</a></li><li><a href=#4-实践应用>4. 实践应用</a></li><li><a href=#5-结论>5. 结论</a></li></ul></nav></nav></div></div></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:dongq@mail.ustc.edu.cn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/SurpriseQiD><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title=QiView><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; QiView 2026</p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><span id=total-views class=site-counter><i class="fa fa-eye"></i>
<span class=leancloud-total-views></span>
</span><script>function showTotalViews(){var e=AV.Object.extend("SiteCounter"),t=new AV.Query(e);t.first().then(function(e){var t=e?e.get("totalViews"):0;document.querySelector(".leancloud-total-views").textContent=t})}showTotalViews()</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){n=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),t=$(this).text(),i=$('<a href="'+o+'" rel="nofollow" title="'+t+'">'+t+"</a>"),s=$('<li class="'+n+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>