<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="QiView"><meta property="og:type" content="article"><meta property="og:image" content="https://SurpriseQiD.github.io//img/home-bg-painting.jpg"><meta property="twitter:image" content="https://SurpriseQiD.github.io//img/home-bg-painting.jpg"><meta name=title content="双重差分法（DID）：准实验的利器"><meta property="og:title" content="双重差分法（DID）：准实验的利器"><meta property="twitter:title" content="双重差分法（DID）：准实验的利器"><meta name=description content="QiView — 一个专注于计算与决策科学的学术知识平台，提供博弈论、机器学习、因果推断等领域的系统化知识。"><meta property="og:description" content="QiView — 一个专注于计算与决策科学的学术知识平台，提供博弈论、机器学习、因果推断等领域的系统化知识。"><meta property="twitter:description" content="QiView — 一个专注于计算与决策科学的学术知识平台，提供博弈论、机器学习、因果推断等领域的系统化知识。"><meta property="twitter:card" content="当我们无法进行完美的随机实验，但拥有政策或事件冲击前后的面板数据时，如何评估其因果效应？本文将介绍在观察性研究中被广泛使用的强大方法——双重差分法（Difference-in-Differences, DID），它通过两次相减来巧妙地剔除混淆偏误。"><meta name=keyword content="博弈论, 决策科学, 运营管理, 人机交互, 机器学习, 因果推断, 大语言模型"><link rel="shortcut icon" href=/img/favicon.png><title>双重差分法（DID）：准实验的利器 | QiView | 计算与决策科学知识平台</title><link rel=canonical href=/knowledge/%E5%9B%A0%E6%9E%9C%E6%8E%A8%E6%96%AD/ci-did/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><link rel=stylesheet href=https://SurpriseQiD.github.io/css/custom.css><link rel=stylesheet href=https://SurpriseQiD.github.io/css/resources.css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><script src=/js/lazysizes.min.js></script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-CX84QDN0SR"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CX84QDN0SR")}</script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container><div class=navbar-header><button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=#navbar-main aria-expanded=false>
<span class=sr-only>切换导航</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/><span class=brand-text>QiView</span></a></div><div class="collapse navbar-collapse" id=navbar-main><ul class="nav navbar-nav navbar-right"><li><a href=/>首页</a></li><li><a href=/knowledge/>知识库</a></li><li><a href=/research/>研究</a></li><li><a href=/blog/>博客</a></li><li><a href=/resources/>资源</a></li><li><a href=/search/>搜索</a></li><li><a href=/about/>关于</a></li><li><a href=/search class=nav-search><i class="fa fa-search"></i></a></li></ul></div></div></nav><script>document.addEventListener("DOMContentLoaded",function(){var n,e=document.querySelector(".navbar-toggle"),t=document.querySelector(".navbar-collapse");e&&e.addEventListener("click",function(){this.classList.toggle("collapsed"),t.classList.toggle("in");var e=this.getAttribute("aria-expanded")==="true";this.setAttribute("aria-expanded",!e)}),n=document.querySelectorAll(".navbar-nav a"),n.forEach(function(n){n.addEventListener("click",function(){window.innerWidth<992&&(t.classList.remove("in"),e&&(e.classList.add("collapsed"),e.setAttribute("aria-expanded","false")))})}),document.addEventListener("click",function(n){var s=n.target.closest(".navbar");!s&&window.innerWidth<992&&(t.classList.remove("in"),e&&(e.classList.add("collapsed"),e.setAttribute("aria-expanded","false")))})})</script><header class=intro-header style=background-image:url(/img/home-bg-painting.jpg)><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=site-heading><h1>QiView</h1><span class=subheading>构建系统化的学术知识生态系统</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-1
col-md-8 col-md-offset-1
col-sm-12
col-xs-12
post-container"><h2 id=1-did的直觉>1. DID的直觉</h2><p>想象一下，一个城市为了缓解交通拥堵，在今年1月1日修建了一条新的地铁线（这是一个“处理”或“政策冲击”）。我们想知道这条地铁线对周边房价的因果效应。</p><p>我们有两组数据：</p><ul><li><strong>处理组（Treatment Group）</strong>: 地铁线周边的社区。</li><li><strong>控制组（Control Group）</strong>: 距离地铁线较远，但其他方面（如社区类型、初始房价等）与处理组相似的社区。</li></ul><p>我们还拥有政策冲击前（比如去年）和冲击后（比如今年）两个时间点的房价数据。</p><p>一个简单的想法是比较处理组在政策前后的房价变化。但这可能不准确，因为整个城市的房价可能都在普遍上涨（时间趋势）。</p><p>另一个简单的想法是比较政策后，处理组和控制组的房价差异。但这同样可能不准确，因为处理组和控制组的房价起点可能就不同。</p><p>**双重差分法（DID）**巧妙地结合了这两种比较：</p><ol><li><p><strong>第一次差分</strong>：分别计算处理组和控制组在政策前后的房价<strong>变化量</strong>。</p><ul><li><code>ΔY_treatment = Y_treatment,post - Y_treatment,pre</code></li><li><code>ΔY_control = Y_control,post - Y_control,pre</code>
这次差分控制了那些不随时间变化的、组间固有的差异（比如处理组的社区环境本身就更好）。</li></ul></li><li><p><strong>第二次差分</strong>：用处理组的变化量减去控制组的变化量。</p><ul><li><code>DID_Effect = ΔY_treatment - ΔY_control</code>
这次差分控制了那些随时间变化、但对两组影响相同的因素（比如整个城市的宏观经济增长导致的房价普涨）。</li></ul></li></ol><p>经过这两次相减，我们得到的 <code>DID_Effect</code> 就被认为是地铁线带来的纯粹因果效应。</p><h2 id=2-平行趋势假设-parallel-trends-assumption>2. 平行趋势假设 (Parallel Trends Assumption)</h2><p>DID方法能够成立，依赖于一个至关重要的假设——<strong>平行趋势假设</strong>。</p><blockquote><p><strong>定义</strong>：平行趋势假设指的是，<strong>如果没有</strong>政策冲击的发生，处理组和控制组的结果变量（房价）随时间变化的<strong>趋势</strong>将会是相同的（即平行的）。</p></blockquote><p>这个假设是反事实的，因为我们永远无法观测到“处理组没有受到政策冲击”的情况。因此，我们无法直接检验它，但可以通过一些方法来增强其可信度：</p><ul><li><strong>检验历史趋势</strong>：如果有多期政策前的数据，我们可以画出处理组和控制组在政策发生前的结果变量变化趋势图。如果它们在历史上是基本平行的，我们就更有理由相信，在没有政策冲击的情况下，它们未来也会保持平行。</li><li><strong>安慰剂检验（Placebo Test）</strong>：我们可以人为地将政策冲击的时间提前，或者将处理组和控制组随机调换，然后重新进行DID估计。如果在一个虚假的设定下，我们仍然得到了显著的效应，那说明我们的模型可能存在问题。</li></ul><h2 id=3-did的回归形式>3. DID的回归形式</h2><p>我们可以用一个简单的回归模型来实现DID估计：</p><p><code>Y_it = β_0 + β_1 * Treat_i + β_2 * Post_t + β_3 * (Treat_i * Post_t) + ε_it</code></p><ul><li><code>Y_it</code>: 个体i在时间t的结果变量。</li><li><code>Treat_i</code>: 一个虚拟变量，如果个体i属于处理组，则为1，否则为0。</li><li><code>Post_t</code>: 一个虚拟变量，如果时间t在政策冲击后，则为1，否则为0。</li><li><code>Treat_i * Post_t</code>: 处理组和政策后虚拟变量的<strong>交互项</strong>。</li></ul><p>在这个回归模型中，我们最关心的就是交互项的系数 <code>β_3</code>。这个系数恰好就是我们想要的DID估计量。</p><ul><li><code>β_1</code> 度量了处理组和控制组之间固有的、不随时间变化的差异。</li><li><code>β_2</code> 度量了政策冲击前后的时间趋势。</li><li><code>β_3</code> 度量了处理组在政策发生后，相对于控制组的<strong>额外</strong>变化量，即处理的因果效应。</li></ul><h2 id=4-did的扩展>4. DID的扩展</h2><p>基础的2x2 DID模型有很多扩展，以适应更复杂的现实情况：</p><ul><li><strong>多期DID</strong>：当有多期政策前和政策后的数据时，可以检验平行趋势假设，并观察效应的动态变化。</li><li><strong>异时DID (Staggered DID)</strong>：当不同个体在不同时间点开始接受处理时，情况会变得更加复杂。近年的研究（如Callaway & Sant&rsquo;Anna, 2021; Sun & Abraham, 2021）指出了传统两步固定效应法（TWFE）在异时DID下的问题，并提出了新的估计方法。</li><li><strong>连续DID</strong>：当处理不是一个0-1变量，而是一个连续变化的强度变量时。</li></ul><h2 id=5-总结>5. 总结</h2><p>双重差分法（DID）是评估政策和事件影响的强大工具，在经济学、社会学、公共卫生等领域有着极其广泛的应用。它的核心思想是通过“差分再差分”来构建一个反事实的对照，从而剥离出因果效应。然而，DID的有效性完全建立在平行趋势假设之上。因此，在应用DID时，进行充分的假设检验和稳健性分析是至关重要的。</p><script src=https://giscus.app/client.js data-repo=SurpriseQiD/hugo-main data-repo-id data-category=Announcements data-category-id data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=light data-lang=zh-CN crossorigin=anonymous async></script></div><div class="col-lg-3 col-md-3 col-sm-12
sidebar-column"><div class=sidebar-container><div class=short-about><div class=sidebar-avatar><a href=/about><img src=/img/avatar-patrickStar.jpg alt=avatar></a></div><p class=sidebar-description>专注于计算与决策科学的学术知识分享平台</p><div class="sidebar-social inline"><a href=mailto:dongq@mail.ustc.edu.cn title=Email aria-label=Email><i class="fas fa-envelope"></i>
</a><a target=_blank href=https://github.com/SurpriseQiD title=GitHub aria-label=GitHub><i class="fab fa-github"></i>
</a><a target=_blank href=https://www.researchgate.net/profile/Qi-Dong-20 title=ResearchGate aria-label=ResearchGate><i class="fab fa-researchgate"></i>
</a><a target=_blank href="https://scholar.google.com/citations?user=dEDX5coAAAAJ&amp;hl=zh-CN&amp;oi=sra" title="Google Scholar" aria-label="Google Scholar"><i class="fas fa-graduation-cap"></i>
</a><a target=_blank href=https://orcid.org/0000-0002-3052-6332 title=ORCID aria-label=ORCID><i class="fab fa-orcid"></i></a></div></div><div class="sidebar-module toc-module"><h4><i class="fas fa-list-alt"></i> 目录</h4><nav id=TableOfContents><nav id=TableOfContents><ul><li><a href=#1-did的直觉>1. DID的直觉</a></li><li><a href=#2-平行趋势假设-parallel-trends-assumption>2. 平行趋势假设 (Parallel Trends Assumption)</a></li><li><a href=#3-did的回归形式>3. DID的回归形式</a></li><li><a href=#4-did的扩展>4. DID的扩展</a></li><li><a href=#5-总结>5. 总结</a></li></ul></nav></nav></div></div></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:dongq@mail.ustc.edu.cn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/SurpriseQiD><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title=QiView><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; QiView 2026</p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><span id=total-views class=site-counter><i class="fa fa-eye"></i>
<span class=leancloud-total-views></span>
</span><script>function showTotalViews(){var e=AV.Object.extend("SiteCounter"),t=new AV.Query(e);t.first().then(function(e){var t=e?e.get("totalViews"):0;document.querySelector(".leancloud-total-views").textContent=t})}showTotalViews()</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){n=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),t=$(this).text(),i=$('<a href="'+o+'" rel="nofollow" title="'+t+'">'+t+"</a>"),s=$('<li class="'+n+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>